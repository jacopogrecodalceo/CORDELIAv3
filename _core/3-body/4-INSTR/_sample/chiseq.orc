gSchiseq_00_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_00.wav"
gichiseq_00_1		 ftgen 0, 0, 0, 1, gSchiseq_00_file, 0, 0, 1
gichiseq_00_2		 ftgen 0, 0, 0, 1, gSchiseq_00_file, 0, 0, 2
;-------
gSchiseq_01_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_01.wav"
gichiseq_01_1		 ftgen 0, 0, 0, 1, gSchiseq_01_file, 0, 0, 1
gichiseq_01_2		 ftgen 0, 0, 0, 1, gSchiseq_01_file, 0, 0, 2
;-------
gSchiseq_02_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_02.wav"
gichiseq_02_1		 ftgen 0, 0, 0, 1, gSchiseq_02_file, 0, 0, 1
gichiseq_02_2		 ftgen 0, 0, 0, 1, gSchiseq_02_file, 0, 0, 2
;-------
gSchiseq_03_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_03.wav"
gichiseq_03_1		 ftgen 0, 0, 0, 1, gSchiseq_03_file, 0, 0, 1
gichiseq_03_2		 ftgen 0, 0, 0, 1, gSchiseq_03_file, 0, 0, 2
;-------
gSchiseq_04_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_04.wav"
gichiseq_04_1		 ftgen 0, 0, 0, 1, gSchiseq_04_file, 0, 0, 1
gichiseq_04_2		 ftgen 0, 0, 0, 1, gSchiseq_04_file, 0, 0, 2
;-------
gSchiseq_05_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_05.wav"
gichiseq_05_1		 ftgen 0, 0, 0, 1, gSchiseq_05_file, 0, 0, 1
gichiseq_05_2		 ftgen 0, 0, 0, 1, gSchiseq_05_file, 0, 0, 2
;-------
gSchiseq_06_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_06.wav"
gichiseq_06_1		 ftgen 0, 0, 0, 1, gSchiseq_06_file, 0, 0, 1
gichiseq_06_2		 ftgen 0, 0, 0, 1, gSchiseq_06_file, 0, 0, 2
;-------
gSchiseq_07_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_07.wav"
gichiseq_07_1		 ftgen 0, 0, 0, 1, gSchiseq_07_file, 0, 0, 1
gichiseq_07_2		 ftgen 0, 0, 0, 1, gSchiseq_07_file, 0, 0, 2
;-------
gSchiseq_08_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_08.wav"
gichiseq_08_1		 ftgen 0, 0, 0, 1, gSchiseq_08_file, 0, 0, 1
gichiseq_08_2		 ftgen 0, 0, 0, 1, gSchiseq_08_file, 0, 0, 2
;-------
gSchiseq_09_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_09.wav"
gichiseq_09_1		 ftgen 0, 0, 0, 1, gSchiseq_09_file, 0, 0, 1
gichiseq_09_2		 ftgen 0, 0, 0, 1, gSchiseq_09_file, 0, 0, 2
;-------
gSchiseq_10_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_10.wav"
gichiseq_10_1		 ftgen 0, 0, 0, 1, gSchiseq_10_file, 0, 0, 1
gichiseq_10_2		 ftgen 0, 0, 0, 1, gSchiseq_10_file, 0, 0, 2
;-------
gSchiseq_11_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_11.wav"
gichiseq_11_1		 ftgen 0, 0, 0, 1, gSchiseq_11_file, 0, 0, 1
gichiseq_11_2		 ftgen 0, 0, 0, 1, gSchiseq_11_file, 0, 0, 2
;-------
gSchiseq_12_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_12.wav"
gichiseq_12_1		 ftgen 0, 0, 0, 1, gSchiseq_12_file, 0, 0, 1
gichiseq_12_2		 ftgen 0, 0, 0, 1, gSchiseq_12_file, 0, 0, 2
;-------
gSchiseq_13_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_13.wav"
gichiseq_13_1		 ftgen 0, 0, 0, 1, gSchiseq_13_file, 0, 0, 1
gichiseq_13_2		 ftgen 0, 0, 0, 1, gSchiseq_13_file, 0, 0, 2
;-------
gSchiseq_14_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_14.wav"
gichiseq_14_1		 ftgen 0, 0, 0, 1, gSchiseq_14_file, 0, 0, 1
gichiseq_14_2		 ftgen 0, 0, 0, 1, gSchiseq_14_file, 0, 0, 2
;-------
gSchiseq_15_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_15.wav"
gichiseq_15_1		 ftgen 0, 0, 0, 1, gSchiseq_15_file, 0, 0, 1
gichiseq_15_2		 ftgen 0, 0, 0, 1, gSchiseq_15_file, 0, 0, 2
;-------
gSchiseq_16_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_16.wav"
gichiseq_16_1		 ftgen 0, 0, 0, 1, gSchiseq_16_file, 0, 0, 1
gichiseq_16_2		 ftgen 0, 0, 0, 1, gSchiseq_16_file, 0, 0, 2
;-------
gSchiseq_17_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_17.wav"
gichiseq_17_1		 ftgen 0, 0, 0, 1, gSchiseq_17_file, 0, 0, 1
gichiseq_17_2		 ftgen 0, 0, 0, 1, gSchiseq_17_file, 0, 0, 2
;-------
gSchiseq_18_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_18.wav"
gichiseq_18_1		 ftgen 0, 0, 0, 1, gSchiseq_18_file, 0, 0, 1
gichiseq_18_2		 ftgen 0, 0, 0, 1, gSchiseq_18_file, 0, 0, 2
;-------
gSchiseq_19_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_19.wav"
gichiseq_19_1		 ftgen 0, 0, 0, 1, gSchiseq_19_file, 0, 0, 1
gichiseq_19_2		 ftgen 0, 0, 0, 1, gSchiseq_19_file, 0, 0, 2
;-------
gSchiseq_20_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_20.wav"
gichiseq_20_1		 ftgen 0, 0, 0, 1, gSchiseq_20_file, 0, 0, 1
gichiseq_20_2		 ftgen 0, 0, 0, 1, gSchiseq_20_file, 0, 0, 2
;-------
gSchiseq_21_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_21.wav"
gichiseq_21_1		 ftgen 0, 0, 0, 1, gSchiseq_21_file, 0, 0, 1
gichiseq_21_2		 ftgen 0, 0, 0, 1, gSchiseq_21_file, 0, 0, 2
;-------
gSchiseq_22_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_22.wav"
gichiseq_22_1		 ftgen 0, 0, 0, 1, gSchiseq_22_file, 0, 0, 1
gichiseq_22_2		 ftgen 0, 0, 0, 1, gSchiseq_22_file, 0, 0, 2
;-------
gSchiseq_23_file 	 init "/Users/j/Documents/PROJECTs/CORDELIA/samples/chiseq/chiseq_23.wav"
gichiseq_23_1		 ftgen 0, 0, 0, 1, gSchiseq_23_file, 0, 0, 1
gichiseq_23_2		 ftgen 0, 0, 0, 1, gSchiseq_23_file, 0, 0, 2
;-------
gichiseq_sonvs[]			fillarray	gichiseq_00_1, gichiseq_00_2, gichiseq_01_1, gichiseq_01_2, gichiseq_02_1, gichiseq_02_2, gichiseq_03_1, gichiseq_03_2, gichiseq_04_1, gichiseq_04_2, gichiseq_05_1, gichiseq_05_2, gichiseq_06_1, gichiseq_06_2, gichiseq_07_1, gichiseq_07_2, gichiseq_08_1, gichiseq_08_2, gichiseq_09_1, gichiseq_09_2, gichiseq_10_1, gichiseq_10_2, gichiseq_11_1, gichiseq_11_2, gichiseq_12_1, gichiseq_12_2, gichiseq_13_1, gichiseq_13_2, gichiseq_14_1, gichiseq_14_2, gichiseq_15_1, gichiseq_15_2, gichiseq_16_1, gichiseq_16_2, gichiseq_17_1, gichiseq_17_2, gichiseq_18_1, gichiseq_18_2, gichiseq_19_1, gichiseq_19_2, gichiseq_20_1, gichiseq_20_2, gichiseq_21_1, gichiseq_21_2, gichiseq_22_1, gichiseq_22_2, gichiseq_23_1, gichiseq_23_2;-------
gkchiseq_time		init 16
gkchiseq_off		init .005
gkchiseq_dur		init 1
gkchiseq_sonvs		init 1
gichiseq_len		init lenarray(gichiseq_sonvs)/2

;------------------

	instr chiseq

imode		init p8
is_opcode	init 1
is_midi		init 2

if imode == is_opcode then

	Sinstr		init "chiseq"
	idur		init p3
	iamp		init p4
	idiv		init p5%i(gksamp_mod)
	ix			init p6
	ich			init p7
	ioff		i gkchiseq_off
	
	if ioff!=0 then
		ioff		random 0, ioff
	endif

	isonvs		i gkchiseq_sonvs%(gichiseq_len+1)

	korgan	chnget	"heart"
	aorgan	a korgan
	aph	= ((aorgan * idiv)+ioff) % 1

	imod		init ich%2
	ift_sonvs	init gichiseq_sonvs[isonvs]+imod
	aout	tablei aph, ift_sonvs, 1
	aout	*= cosseg:a(0, ix, 1, idur-(ix*2), 1, ix, 0)
	aout	*= $ampvar

	$mix

elseif imode == is_midi then

	Sinstr		init "chiseq"
	idur		init p3
	iamp		init p4
	iftenv		init p5
	idiv		init p6%i(gksamp_mod)
	ich			init p7
	isonvs		init p9
	ix			init idur/4
	ioff		i gkchiseq_off
	
	if ioff!=0 then
		ioff		random 0, ioff
	endif

	isonvs		= isonvs%(gichiseq_len+1)

	ifreq	init limit(1/idur, .125, idiv/8)
	aph		tablei phasor(ifreq/2), gitri, 1

	imod		init ich%2
	ift_sonvs	init gichiseq_sonvs[isonvs]+imod
	aout	tablei aph, ift_sonvs, 1
	aout	*= $ampvar

	ienvvar		init idur/5

	$death

else

	Sinstr		init "chiseq"
	idur		init p3
	iamp		init p4
	iftenv		init p5
	idiv		init p6%i(gksamp_mod)
	ich			init p7
	ix			init idur/4
	ioff		i gkchiseq_off
	
	if ioff!=0 then
		ioff		random 0, ioff
	endif

	isonvs		i gkchiseq_sonvs%(gichiseq_len+1)

	korgan	chnget	"heart"
	aorgan	a korgan
	aph	= ((aorgan * idiv)+ioff) % 1

	imod		init ich%2
	ift_sonvs	init gichiseq_sonvs[isonvs]+imod
	aout	tablei aph, ift_sonvs, 1
	aout	*= $ampvar

	ienvvar		init idur/5

	$death

endif

	endin

;------------------

	opcode	chiseq, 0, iJ
idiv, kamp xin

if kamp == -1 then
	kamp = $f
endif

Sinstr	init "chiseq"
imax	init 8
kndx 	init 1

is_opcode init 1

if 	hex("8", gkchiseq_time) == 1 then

	if kndx == imax+1 then
		kndx = 1
	endif

	kdur	= gkbeats*gkchiseq_dur

	kx		= kdur/4

	kch		= 1

	until kch > ginchnls do
		schedulek nstrnum(Sinstr)+(kndx/1000), 0, kdur+kx, kamp, idiv, kx, kch, is_opcode
		#ifdef	printscore
			kdone	system gkabstime, sprintfk("echo \'i\t\"%s\"\t%f\t%f\t%f\t%i\t%f\' >> %s", Sinstr, gkabstime, kdur, kamp, kenv, kcps1, kch, gScorename)
		#end
		if	kch == 1 then
			printsk "• %s\t%.1fs | %.3f | %.2f\n", Sinstr, kamp, kdur+kx, idiv
		endif
		kch += 1
	od
	kndx += 1
endif

	endop

	opcode	chiseq, 0, kJ
kdiv, kamp xin

if kamp == -1 then
	kamp = $f
endif

Sinstr	init "chiseq"
imax	init 8
kndx 	init 1

is_opcode init 1

if 	hex("8", gkchiseq_time) == 1 then

	if kndx == imax+1 then
		kndx = 1
	endif

	kdur	= gkbeats*gkchiseq_dur

	kx		= kdur/4

	kch		= 1

	until kch > ginchnls do
		schedulek nstrnum(Sinstr)+(kndx/1000), 0, kdur+kx, kamp, kdiv, kx, kch, is_opcode
		#ifdef	printscore
			kdone	system gkabstime, sprintfk("echo \'i\t\"%s\"\t%f\t%f\t%f\t%i\t%f\' >> %s", Sinstr, gkabstime, kdur, kamp, kenv, kcps1, kch, gScorename)
		#end
		if	kch == 1 then
			printsk "• %s\t%.1fs | %.3f | %.2f\n", Sinstr, kamp, kdur+kx, kdiv
		endif
		kch += 1
	od
	kndx += 1
endif

	endop	
